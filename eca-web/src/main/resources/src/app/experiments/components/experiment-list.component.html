<div class="container-fluid mb-5">
  <p-tabView class="experiment-tab">
    <p-tabPanel header="Таблица экспериментов">
      <div class="row">
        <div class="col-2">
          <app-filter [filters]="filters" (search)="onSearch()"></app-filter>
        </div>
        <div class="col-10">
          <p-table
            class="experiments-table"
            [columns]="columns"
            [value]="items"
            [rows]="pageSize"
            [paginator]="true"
            [scrollable]="true"
            [sortField]="defaultSortField"
            [sortOrder]="defaultSortOrder"
            [lazy]="true"
            [loading]="loading"
            (onLazyLoad)="onLazyLoad($event)">

            <ng-template pTemplate="caption">
              <app-request-statuses-statistics
                [requestStatusStatisticsDto]="requestStatusStatisticsDto">
              </app-request-statuses-statistics>
            </ng-template>

            <ng-template pTemplate="header">
              <tr>
                <ng-container *ngFor="let column of columns">
                  <th *ngIf="!notSortable(column.name)" [pSortableColumn]="column.name">
                    {{ column.label }}
                    <p-sortIcon [field]="column.label"></p-sortIcon>
                  </th>
                  <th *ngIf="notSortable(column.name)">{{ column.label }}</th>
                </ng-container>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-item>
              <tr>
                <td *ngFor="let column of columns">
                  <a [routerLink]="" *ngIf="isLink(column.name)" (click)="onLink(column.name, item)">
                    {{ item[column.name] }}
                  </a>
                  <span *ngIf="!isLink(column.name)">{{ item[column.name] }}</span>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage" *ngIf="items.length == 0">
              <tr>
                <td [attr.colspan]="columns.length" class="text-center">
                  Не найдено ни одного эксперимента
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </p-tabPanel>

    <p-tabPanel header="Статистика">
      <app-experiment-statistics></app-experiment-statistics>
    </p-tabPanel>

  </p-tabView>
</div>

<app-ers-report
  [visible]="ersReportVisibility"
  [ersReport]="ersReport"
  (visibilityChange)="onErsReportVisibilityChange($event)"
  (sent)="onEvaluationResultsSent($event)">
</app-ers-report>
