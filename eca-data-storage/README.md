Модуль eca-data-storage
========================================

Описание
----------------------------------------
   Основным предназначением модуля является сохранение файлов с обучающей выборкой в базу данных.
При этом, система поддерживает файлы следующих форматов: arff, xls, xlsx, csv, json, txt, data, docx, xml.
Система также поддерживает сохранение имен атрибутов, представленных кириллицей. При сохранении в базу,
данные подвергаются следующим преобразованиям:

1. Каждый специальный символ в имени атрибута преобразуется в символ '_'. Отметим, что
к специальным символам не относятся цифры, буквы латинского алфавита и кириллица.

2. Каждый специальный символ в имени таблицы преобразуется в символ '_'.

3. Если длина значения номинального атрибута превышает 255 символов, то оно обрезается
до соответствующей длины.

Необходимый софт
----------------------------------------
* Openjdk 1.11
* maven >= 3.3.9
* eca-core 6.8.1
* База данных PostgreSQL для хранения информации.

Описание ключевой конфигурации модуля
----------------------------------------
Настройки для проекта eca-data-storage находятся в application.yml. Основные параметры:
1) spring.datasource - настройки БД для хранения информации
2) spring.tokendatasource - настройки БД для хранения авторизационных токенов
3) eca-ds — основные настройки модуля:
   * eca-ds.dateFormat - формат даты для атрибутов типа "Дата"
   * eca-ds.batchSize - размер блока для транзакционного сохранения данных в базу данных
   * eca-ds.maxPageSize - максимальное число элементов на странице (используется для запросов с пагинацией)
4) swagger2 - настройки Swagger
   * swagger2.tokenBaseUrl - базовый url - сервера авторизации
   * swagger2.clientId - идентификатор клиента
   * swagger2.secret - пароль клиента
   * swagger2.groups - Groups map с мета информацией для swagger
    
Инструкция по развертыванию
----------------------------------------

1. Для запуска модуля необходимо собрать проект с помощью команды:
    
   mvn clean install
    
2. Развернуть target/eca-data-storage.war на одном из контейнеров сервлетов (например, Tomcat 8) с контекстом /eca-data-storage.

Страница с документацией swagger находится по адресу http://[host]:[port]/eca-data-storage/swagger-ui.html, где host и port
соответственно адрес машины и порт на котором развернуто приложение.

End point для сохранения данных доступен по адресу http://[host]:[port]/eca-data-storage/instances/save. Где host и port - адрес хоста и номер порта, на котором развернуто приложение.
Ниже приведен пример команды через утилиту curl для миграции данных через end point:

curl -i -X POST -H "Content-Type: multipart/form-data" -F "trainingData=@/home/roman/soybean.arff" -F "tableName=soybean" http://localhost:8080/eca-data-storage/instances/save
